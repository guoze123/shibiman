<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0"
    />
    <title></title>
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <link href="css/bootstrap.min.css" rel="stylesheet" />
    <link href="css/font-awesome.css?v=4.4.0" rel="stylesheet" />
    <link href="css/animate.css" rel="stylesheet" />
    <link href="css/style.css" rel="stylesheet" />
    <link href="css/login.css" rel="stylesheet" />
    <!--[if lt IE 9]>
      <meta http-equiv="refresh" content="0;ie.html" />
    <![endif]-->
    <style>
      .has-error {
        color: #a94442;
      }
    </style>
    <script>
      if (window.top !== window.self) {
        window.top.location = window.location;
      }
    </script>
  </head>

  <body class="signin">
    <div class="signinpanel">
      <div class="row">
        <div class="col-sm-7">
          <div class="signin-info">
            <div class="logopanel m-b">
              <h1></h1>
            </div>
            <div class="m-b"></div>
            <h4>欢迎使用 <strong></strong></h4>
            <ul class="m-b">
              <li><i class="fa fa-arrow-circle-o-right m-r-xs"></i> 优势一</li>
              <li><i class="fa fa-arrow-circle-o-right m-r-xs"></i> 优势二</li>
              <li><i class="fa fa-arrow-circle-o-right m-r-xs"></i> 优势三</li>
              <li><i class="fa fa-arrow-circle-o-right m-r-xs"></i> 优势四</li>
              <li><i class="fa fa-arrow-circle-o-right m-r-xs"></i> 优势五</li>
            </ul>
            <strong>已有账号！ <a href="login.html">点此登录;</a></strong>
          </div>
        </div>
        <div class="col-sm-5">
          <h4 class="no-margins">注册：</h4>
          <p class="m-t-md">登录到H+后台主题UI框架</p>
          <input
            type="text"
            class="form-control  employeeId uname"
            autocomplete="off"
            placeholder="员工编号"
          />
          <input
            type="text"
            class="form-control uname phoneNumber"
            autocomplete="off"
            placeholder="手机号"
          />
          <input
            type="password"
            class="form-control pword m-b"
            autocomplete="off"
            placeholder="密码"
          />
          <input
            type="password"
            class="form-control confirmPasswd m-b"
            autocomplete="off"
            placeholder="确认密码"
          />
          <button class="btn btn-success btn-block btn-register">注册</button>
        </div>
      </div>
      <div class="signup-footer">
        <div class="pull-left"></div>
      </div>
    </div>
  </body>
  <script src="js/jquery.min.js?v=2.1.4"></script>
  <script src="js/bootstrap.min.js?v=3.3.6"></script>
  <script src="./js/common.js"></script>
  <script src="js/plugins/layer/layer.min.js"></script>
  <script src="./js/loading.js"></script>
  <script>
    var phoneReg = /^1[0-9]{10}$/,
      passwordReg = /^[0-9a-zA-Z]{6,10}$/;
    function validationPhone(that) {
      let errStr =
        '<span id="phone-error" class="has-error help-block m-b-none"><i class="fa fa-times-circle"></i>请输入有效的手机号</span>';
      if ($(that).val()) {
        if (phoneReg.test($(that).val())) {
          $("#phone-error").remove();
        } else {
          if (!$("#phone-error").length) {
            $(that).after(errStr);
          }
        }
      } else {
        $("#phone-error").remove();
      }
    }
    function validationPassword(that) {
      let errStr =
        '<span id="password-error" class="has-error help-block m-b-none"><i class="fa fa-times-circle"></i>6-10位数字字母组成的字符</span>';
      if ($(that).val()) {
        if (passwordReg.test($(that).val())) {
          $("#password-error").remove();
        } else {
          if (!$("#password-error").length) {
            $(that).after(errStr);
          }
        }
      } else {
        $("#password-error").remove();
      }
    }

    $(".btn-register").click(function() {
      if (
        $(".pword").val() &&
        $(".confirmPasswd").val() &&
        $(".phoneNumber").val() &&
        $(".employeeId").val()
      ) {
        if ($(".pword").val() !== $(".confirmPasswd").val()) {
          tips("密码填写不一致", 5);
          return;
        }
      } else {
        tips("将注册信息填写完整", 5);
        return;
      }

      var params = {
        phoneNumber: $(".phoneNumber").val(),
        passwd: $(".pword").val(),
        employeeId: $(".employeeId").val()
      };
      ajax_data(
        "/common/register",
        { params: JSON.stringify(params) },
        function(res) {
          if (res.resultCode > -1) {
            setCookie("phoneNumber", res.personalInfo.phoneNumber);
            setCookie("employeeName", res.personalInfo.employeeName);
            setCookie("job", res.personalInfo.job);
            setCookie("ownerId", res.personalInfo.ownerId);
            setCookie("employeeId", res.personalInfo.employeeId);

            window.location.href = "index.html";
          } else if (res.resultCode == -2) {
            tips("用户已存在", 5);
          } else {
            tips("注册失败，请检查注册信息", 5);
          }
        }
      );
    });
    $(document).keyup(function(event) {
      if (event.keyCode == 13 || event.keyCode == 108) {
        $(".btn-register").trigger("click");
      }
    });
  </script>
</html>
